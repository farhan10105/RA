<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Mr. Fries</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <style>
    body{font-family:Arial, sans-serif;margin:0;background:#fff8f0;color:#333}
    header{background:#ff7f50;color:#fff;padding:1rem;text-align:center}
    h1{margin:0;font-size:1.8rem}
    .container{max-width:900px;margin:auto;padding:1rem}
    .card{background:#ffe5b4;margin:1rem 0;padding:1rem;border-radius:12px}
    ul{list-style:none;padding:0}
    li{background:#fff;padding:.5rem;border-radius:8px;margin:.3rem 0;display:flex;justify-content:space-between;align-items:center}
    .btn{background:#ff7f50;color:#fff;border:none;padding:.7rem 1rem;border-radius:8px;cursor:pointer;text-decoration:none;display:inline-block;margin:.3rem 0;font-size:1rem}
    .btn:hover{background:#e5673f}
    footer{text-align:center;margin:2rem 0;font-size:.9rem;color:#555}
    #admin-panel{display:none}
    #login-box{display:none;text-align:center;padding:1rem}
    input,select,textarea{padding:.6rem;border:1px solid #ccc;border-radius:6px;width:100%;margin:.3rem 0;font-size:1rem}
    textarea{min-height:60px;resize:vertical}
    .remove-btn{background:#f55;color:#fff;border:none;padding:.3rem .6rem;border-radius:6px;cursor:pointer;margin-left:.5rem}
    #calc p{margin:.3rem 0}
    .review{background:#fff;padding:.6rem;border-radius:8px;margin:.6rem 0;font-size:.95rem}
    .stars{color:gold}
    .reply{margin-top:.5rem;padding:.5rem;background:#f9f9f9;border-left:3px solid #ff7f50;font-size:.9rem}
    /* Splash Screen */
    #splash{
      position:fixed;
      top:0;left:0;width:100%;height:100%;
      background:#ff7f50;color:#fff;
      display:flex;flex-direction:column;
      align-items:center;justify-content:center;
      font-size:2rem;z-index:9999;
    }
    #splash p{font-size:1.2rem;margin-top:1rem}
    #splash.fade{opacity:0;transition:opacity 1s ease-out;pointer-events:none}
    /* Quantity Control */
    .qty-control {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      margin-left: 10px;
    }
    .qty-control button {
      background: #ff7f50;
      color: #fff;
      border: none;
      width: 28px;
      height: 28px;
      border-radius: 6px;
      font-size: 18px;
      cursor: pointer;
    }
    .qty-control button:hover {background:#e5673f}
    .qty-control span {
      min-width: 20px;
      text-align: center;
      font-weight: bold;
    }
    @media (max-width:600px){
      header h1{font-size:1.5rem}
      .card{padding:.8rem}
      .btn{width:100%;padding:.8rem;font-size:1rem}
      input,select,textarea{font-size:1rem}
      li{flex-direction:column;align-items:flex-start}
    }
  </style>
</head>
<body>

<!-- Splash Screen -->
<div id="splash">
  <h1>üçü Mr. Fries</h1>
  <p>Welcome to the Fries World!</p>
</div>

<header>
  <h1>üçü Mr. Fries</h1>
  <p>Small D Ground near Donner | Phone: 
    <a href="tel:03018655584" style="color:#fff;text-decoration:underline">03018655584</a></p>
  <p>Owner: Akhter Rasool Sb</p>
  <button class="btn" onclick="showLogin()">Admin</button>
</header>

<div class="container">
  <div id="site-view">
    <div class="card">
      <h2>Menu</h2>
      <ul id="menu-list"></ul>
    </div>

    <div class="card" id="calc">
      <h2>üßæ Calculator</h2>
      <p>Subtotal: Rs.<span id="subtotal">0</span></p>
      <p>Discount: Rs.<span id="discount">0</span></p>
      <p><b>Total: Rs.<span id="final">0</span></b></p>
    </div>

    <div class="card">
      <h2>Discount Packages</h2>
      <p>Order up to Rs.1500 to achieve <b>10% Discount</b> üéâ</p>
    </div>

    <div class="card">
      <h2>Place Order</h2>
      <label>Your Name: <input id="cust-name" type="text"></label>
      <label>Address/Note: <input id="cust-note" type="text"></label>
      <button class="btn" onclick="orderWhatsApp()">Order on WhatsApp</button>
    </div>

    <div class="card">
      <h2>‚≠ê Customer Reviews</h2>
      <label>Name: <input id="rev-name" type="text"></label>
      <label>Rating:
        <select id="rev-rating">
          <option value="5">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</option>
          <option value="4">‚≠ê‚≠ê‚≠ê‚≠ê</option>
          <option value="3">‚≠ê‚≠ê‚≠ê</option>
          <option value="2">‚≠ê‚≠ê</option>
          <option value="1">‚≠ê</option>
        </select>
      </label>
      <label>Review:<textarea id="rev-text"></textarea></label>
      <button class="btn" onclick="addReview()">Submit Review</button>
      <div id="reviews-list"></div>
    </div>
  </div>

  <!-- Login Box -->
  <div id="login-box" class="card">
    <h2>Admin Login</h2>
    <input type="password" id="admin-pass" placeholder="Enter Password">
    <button class="btn" onclick="checkLogin()">Login</button>
    <button class="btn" onclick="cancelLogin()">Cancel</button>
  </div>

  <!-- Admin Panel -->
  <div id="admin-panel" class="card">
    <h2>Admin Panel</h2>
    <h3>Menu Manager</h3>
    <ul id="admin-menu-list"></ul>
    <input id="new-item-name" placeholder="Item name">
    <input id="new-item-price" type="number" placeholder="Price">
    <button class="btn" onclick="addItem()">Add Item</button>
    <hr>
    <h3>Reviews Manager</h3>
    <div id="admin-reviews"></div>
    <hr>
    <h3>Change Password</h3>
    <input type="password" id="new-pass" placeholder="New Password">
    <button class="btn" onclick="changePassword()">Change</button>
    <hr>
    <button class="btn" onclick="closeAdmin()">Close Admin</button>
  </div>
</div>

<footer>&copy; 2025 Mr. Fries</footer>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database-compat.js"></script>

<script>
  // üî• Replace this with your own Firebase config
  const firebaseConfig = {
    apiKey: "YOUR_API_KEY",
    authDomain: "YOUR_PROJECT.firebaseapp.com",
    databaseURL: "https://YOUR_PROJECT-default-rtdb.firebaseio.com",
    projectId: "YOUR_PROJECT",
    storageBucket: "YOUR_PROJECT.appspot.com",
    messagingSenderId: "XXXXXX",
    appId: "XXXXXX"
  };
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Default data
  const defaultData = {
    menu:[{name:"Fries",price:200}],
    password:"admin123",
    reviews:[]
  };

  let DATA = {...defaultData};

  // Sync with Firebase
  db.ref("mrfries").on("value", snapshot => {
    if(snapshot.exists()){
      DATA = snapshot.val();
    } else {
      db.ref("mrfries").set(defaultData);
      DATA = {...defaultData};
    }
    renderMenu();
    renderReviews();
  });

  // Save to Firebase
  function saveData(){
    db.ref("mrfries").set(DATA);
  }

  // --- UI Functions ---
  function renderMenu(){
    const ul = document.getElementById("menu-list");
    ul.innerHTML = "";
    DATA.menu.forEach((item, i) => {
      const li = document.createElement("li");
      li.innerHTML = `<span>${item.name} - Rs.${item.price}</span>
        <div class="qty-control">
          <button onclick="changeQty(${i},-1)">-</button>
          <span id="qty-${i}">0</span>
          <button onclick="changeQty(${i},1)">+</button>
        </div>`;
      ul.appendChild(li);
    });
    updateCalc();
    renderAdminMenu();
  }

  function changeQty(i, delta){
    let span = document.getElementById("qty-"+i);
    let q = parseInt(span.innerText) || 0;
    q += delta;
    if(q < 0) q = 0;
    span.innerText = q;
    updateCalc();
  }

  function updateCalc(){
    let subtotal = 0;
    DATA.menu.forEach((item, i) => {
      let q = parseInt(document.getElementById("qty-"+i)?.innerText) || 0;
      subtotal += q * item.price;
    });
    let discount = (subtotal >= 1500) ? Math.round(subtotal * 0.1) : 0;
    let total = subtotal - discount;
    document.getElementById("subtotal").innerText = subtotal;
    document.getElementById("discount").innerText = discount;
    document.getElementById("final").innerText = total;
  }

  function orderWhatsApp(){
    let items = [];
    let subtotal = 0;
    DATA.menu.forEach((it, i) => {
      let q = parseInt(document.getElementById("qty-"+i)?.innerText) || 0;
      if(q > 0){
        items.push(`${it.name} x${q} = Rs.${q*it.price}`);
        subtotal += q * it.price;
      }
    });
    if(items.length === 0){ alert("Please select items first"); return; }
    let discount = (subtotal >= 1500) ? Math.round(subtotal * 0.1) : 0;
    let total = subtotal - discount;
    let msg = `Name: ${document.getElementById("cust-name").value}\n\nOrder:\n${items.join("\n")}\n\nSubtotal: Rs.${subtotal}\nDiscount: Rs.${discount}\nTotal: Rs.${total}\n\nAddress/Note: ${document.getElementById("cust-note").value}`;
    let phone = "923018655584";
    window.open("https://wa.me/"+phone+"?text="+encodeURIComponent(msg), "_blank");
  }

  // --- Reviews ---
  function renderReviews(){
    const list = document.getElementById("reviews-list");
    list.innerHTML = "";
    DATA.reviews.forEach((r, i) => {
      const div = document.createElement("div");
      div.className = "review";
      div.innerHTML = `<b>${r.name}</b> <span class="stars">${"‚≠ê".repeat(r.rating)}</span><br>${r.text}${r.reply ? `<div class="reply"><b>Admin:</b> ${r.reply}</div>` : ""}`;
      list.appendChild(div);
    });
    renderAdminReviews();
  }
  
  function addReview(){
    let name = document.getElementById("rev-name").value.trim();
    let rating = +document.getElementById("rev-rating").value;
    let text = document.getElementById("rev-text").value.trim();
    if(!name || !text){ alert("Enter name & review"); return; }
    DATA.reviews.push({name, rating, text, reply:""});
    saveData();
  }

  function renderAdminReviews(){
    const div = document.getElementById("admin-reviews");
    if(!div) return;
    div.innerHTML = "";
    DATA.reviews.forEach((r, i) => {
      const box = document.createElement("div");
      box.className = "review";
      box.innerHTML = `<b>${r.name}</b> ${"‚≠ê".repeat(r.rating)}<br>${r.text}
        <br><input id="reply-${i}" placeholder="Reply" value="${r.reply || ""}">
        <button class="btn" onclick="saveReply(${i})">Save Reply</button>`;
      div.appendChild(box);
    });
  }
  
  function saveReply(i){
    DATA.reviews[i].reply = document.getElementById("reply-"+i).value.trim();
    saveData();
  }

  // --- Admin ---
  function renderAdminMenu(){
    const ul = document.getElementById("admin-menu-list");
    if(!ul) return;
    ul.innerHTML = "";
    DATA.menu.forEach((item, i) => {
      const li = document.createElement("li");
      li.innerHTML = `${item.name} - Rs.${item.price} <button class="remove-btn" onclick="removeItem(${i})">X</button>`;
      ul.appendChild(li);
    });
  }

  function addItem(){
    let n = document.getElementById("new-item-name").value.trim();
    let p = +document.getElementById("new-item-price").value;
    if(!n || !p){ alert("Enter name & price"); return; }
    DATA.menu.push({name: n, price: p});
    saveData();
  }
  
  function removeItem(i){
    DATA.menu.splice(i, 1);
    saveData();
  }

  function showLogin(){ document.getElementById("login-box").style.display = "block"; }
  function cancelLogin(){ document.getElementById("login-box").style.display = "none"; }
  function checkLogin(){
    let p = document.getElementById("admin-pass").value;
    if(p === DATA.password){
      document.getElementById("login-box").style.display = "none";
      document.getElementById("admin-panel").style.display = "block";
      renderAdminMenu();
      renderAdminReviews();
    } else { alert("Wrong Password"); }
  }
  function closeAdmin(){ document.getElementById("admin-panel").style.display = "none"; }
  function changePassword(){
    let np = document.getElementById("new-pass").value.trim();
    if(np.length < 4){ alert("Password too short"); return; }
    DATA.password = np;
    saveData();
    alert("Password Changed!");
  }

  // Splash
  document.addEventListener("DOMContentLoaded", () => {
    let splash = document.getElementById("splash");
    setTimeout(() => {
      splash.classList.add("fade");
      setTimeout(()=>{ splash.style.display="none"; },1000);
    }, 2500);
  });
</script>
</body>
</html>
